<!DOCTYPE html>
<html>

<head>
    <title>Refrigerator Freezer Monitor with Dual Sensors and Slack Notifications</title>
</head>

<body>

    <h1>Refrigerator Freezer Monitor with Dual Sensors and Slack Notifications</h1>

    <p>This Python script is designed to monitor the temperature and humidity of two locations, "Freezer" and "Fridge," using BME280 sensors connected to a Raspberry Pi.
        The script periodically reads sensor data, logs it to an Initial State bucket, and sends alerts to a Slack channel if the temperature in either location exceeds certain thresholds for a specified number of consecutive readings.</p>

    <h2>Libraries Used:</h2>

    <p>
        <ul>
            <li><code>time</code>: Provides functions for time-related operations.</li>
            <li><code>smbus2</code>: Allows communication with I2C devices on the Raspberry Pi.</li>
            <li><code>bme280</code>: Provides functions to interface with the BME280 sensor and read its data.</li>
            <li><code>ISStreamer.Streamer</code>: Used to stream data to Initial State, a data visualization and analytics platform.</li>
            <li><code>slack_sdk.WebClient</code>: Enables interaction with the Slack Web API.</li>
            <li><code>slack_sdk.errors.SlackApiError</code>: Represents errors that may occur when interacting with the Slack API.</li>
        </ul>
    </p>

    <h2>User Settings (Variables to Customize):</h2>

    <p>
        <ul>
            <li><code>SENSOR_LOCATION_NAME_1</code> and <code>SENSOR_LOCATION_NAME_2</code>: The names of the two sensor locations ("Freezer" and "Fridge"). Customize these according to your setup.</li>
            <li><code>BUCKET_NAME</code> and <code>BUCKET_KEY</code>: The name and key of the Initial State bucket where data will be logged.</li>
            <li><code>ACCESS_KEY</code>: Your Initial State access key for authentication.</li>
            <li><code>MINUTES_BETWEEN_READS</code>: The time interval between sensor readings in minutes.</li>
            <li><code>SLACK_API_TOKEN</code>: Your Slack API token for sending notifications to a Slack channel.</li>
        </ul>
    </p>

    <h2>Sensor Initialization:</h2>

    <p>
        <ul>
            <li><code>port</code>: The I2C port number on the Raspberry Pi.</li>
            <li><code>address_1</code> and <code>address_2</code>: The I2C addresses of the BME280 sensors connected to "Freezer" and "Fridge," respectively.</li>
            <li><code>bus_1</code> and <code>bus_2</code>: Instances of the SMBus to communicate with the BME280 sensors.</li>
            <li><code>calibration_params_1</code> and <code>calibration_params_2</code>: Calibration parameters loaded for each sensor.</li>
        </ul>
    </p>

    <h2>Initial State Streamer Initialization:</h2>

    <p>
        <ul>
            <li><code>streamer_1</code> and <code>streamer_2</code>: Instances of the Initial State Streamer for each sensor location.</li>
        </ul>
    </p>

    <h2>Main Loop:</h2>

    <p>
        The script enters an infinite loop to continuously read sensor data and perform actions. For each iteration, it follows these steps for both sensor locations ("Freezer" and "Fridge"):
    </p>

    <h3>For "Freezer" (Sensor 1):</h3>

    <ol>
        <li>Read data from the BME280 sensor connected to the "Freezer".</li>
        <li>Convert the temperature from Celsius to Fahrenheit.</li>
        <li>Log the temperature and humidity data to the Initial State Streamer for "Freezer".</li>
        <li>Check if the "Freezer" temperature is above 17°F for the specified number of consecutive intervals (<code>THRESHOLD_COUNT</code>).</li>
        <li>If the threshold is exceeded, send an alert message to the Slack channel specified by "#your-slack-channel".</li>
    </ol>

    <h3>For "Fridge" (Sensor 2):</h3>

    <ol>
        <li>Read data from the BME280 sensor connected to the "Fridge".</li>
        <li>Convert the temperature from Celsius to Fahrenheit.</li>
        <li>Log the temperature and humidity data to the Initial State Streamer for "Fridge".</li>
        <li>Check if the "Fridge" temperature is above 40°F for the specified number of consecutive intervals (<code>THRESHOLD_COUNT</code>).</li>
        <li>If the threshold is exceeded, send an alert message to the Slack channel specified by "#your-slack-channel".</li>
    </ol>

    <h2>Sleep:</h2>

    <p>
        The script then sleeps for the specified interval (<code>MINUTES_BETWEEN_READS</code> in minutes) before the next iteration.
    </p>

    <h2>Note:</h2>

    <p>
        <ul>
            <li>Replace the placeholders (<code>YOUR-BUCKET-NAME-HERE</code>, <code>YOUR-BUCKET-KEY-HERE</code>, <code>YOUR KEY HERE</code>, and <code>YOUR-SLACK-API-TOKEN-HERE</code>) in the user settings with appropriate values.</li>
            <li>Ensure that the required libraries (<code>smbus2</code>, <code>bme280</code>, <code>ISStreamer</code>, <code>slack_sdk</code>) are installed before running the script.</li>
            <li>Set up the Initial State and Slack API configurations properly to receive and visualize the sensor data and notifications effectively.</li>
        </ul>
    </p>

</body>

</html>
